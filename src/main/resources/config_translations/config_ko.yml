# ═══════════════════════════════════════════════════════════════════════════════
# The Endex - 동적 시장 경제 플러그인 설정
# ═══════════════════════════════════════════════════════════════════════════════
# 수정 후, /endex reload를 실행(관리자 권한 필요)하거나 서버를 재기동하십시오.
#
# ═══════════════════════════════════════════════════════════════════════════════
# 🚀 자원 사용 최소화 최적화 완료 (v1.5.8-JAN80235)
# ═══════════════════════════════════════════════════════════════════════════════
# 이 설정은 기본적으로 '낮은 자원 사용'을 위해 사전 최적화되어 있습니다.
# 중소규모 서버 또는 성능 영향을 최소화하려는 서버에 적합합니다.
#
# 적용된 주요 최적화 사항:
#   ✓ 월드 스토리지 스캔 비활성화 (CPU 부하 대폭 감소)
#   ✓ 업데이트 시마다 저장 비활성화 (디스크 I/O 감소)
#   ✓ 업데이트 간격 연장 (계산 빈도 감소)
#   ✓ SQLite 스토리지 활성화 (YAML보다 빠름)
#   ✓ 청크 캐싱 활성화 (월드 스캔 사용 시)
#   ✓ 최소 히스토리 길이 (메모리 사용량 감소)
#
# 모든 기능 활성화 시 (자원 사용량 증가):
#   - price-world-storage.enabled: true 설정 (동적 희소성 가격 책정)
#   - update-interval-seconds를 60으로 단축 (더 즉각적인 시장 반응)
#   - history-length를 120으로 증가 (더 상세한 차트 제공)
#
# ═══════════════════════════════════════════════════════════════════════════════
# 성능 가이드 (PERFORMANCE GUIDE)
# ═══════════════════════════════════════════════════════════════════════════════
# 각 옵션에는 성능 영향도가 표시되어 있습니다:
#   [PERF: MINIMAL]  - 영향 미미. 모든 서버에서 안전합니다.
#   [PERF: LOW]      - 낮은 CPU/메모리 사용량. 모든 서버에서 안전합니다.
#   [PERF: MEDIUM]   - 중간 수준의 영향. 서버 규모에 따라 조정하십시오.
#   [PERF: HIGH]     - 영향 큼. 대규모 서버(플레이어 50인 이상)를 위한 최적화 필요.
#   [PERF: CRITICAL] - 높은 리소스 사용. 신중한 조정 권장.
#
# 대규모 서버를 위한 팁:
#   - update-interval-seconds 늘리기 (300-600)
#   - price-world-storage 비활성화 또는 scanned-worlds 제한
#   - world-storage의 chunk-caching 활성화
#   - history-length를 30-50으로 줄이기
#   - YAML 대신 SQLite 스토리지 사용
# ═══════════════════════════════════════════════════════════════════════════════

# 내부 버전 (변경 감지용). 수정하지 마십시오.
config-version: 1

# ───────────────────────────────────────────────────────────────────────────────
# 언어 설정
# ───────────────────────────────────────────────────────────────────────────────
language:
  locale: ko

# ───────────────────────────────────────────────────────────────────────────────
# 가격 업데이트 주기 [PERF: MEDIUM]
# ───────────────────────────────────────────────────────────────────────────────
# 시장이 수요와 공급에 따라 가격을 재계산하는 주기(초).
# 권장: 중소규모 60s, 대규모/혼잡한 서버 120-300s.
update-interval-seconds: 60

# ───────────────────────────────────────────────────────────────────────────────
# 가격 민감도 [PERF: MINIMAL]
# ───────────────────────────────────────────────────────────────────────────────
# 수요/공급 불균형이 가격에 미치는 영향력을 제어합니다.
# 권장: 0.05 (순수요 1단위당 5% 변화)
price-sensitivity: 0.05

# ───────────────────────────────────────────────────────────────────────────────
# 히스토리 추적 [PERF: LOW]
# ───────────────────────────────────────────────────────────────────────────────
# 차트용으로 보관할 과거 가격 데이터 포인트 개수.
# 권장: 스파크라인용 5-10, 상세 웹 차트용 50-120.
history-length: 5

# ───────────────────────────────────────────────────────────────────────────────
# 자동 저장 및 백업 [PERF: LOW to MEDIUM]
# ───────────────────────────────────────────────────────────────────────────────
# 시장 데이터를 디스크에 저장하는 빈도(분).
autosave-minutes: 5

# 업데이트 시마다 즉시 market.yml 저장 (YAML 모드 전용).
# [PERF: 활성화 시 HIGH]
save-on-each-update: false

# ───────────────────────────────────────────────────────────────────────────────
# 데이터 저장 모드 [PERF: MEDIUM to HIGH]
# ───────────────────────────────────────────────────────────────────────────────
# SQLite (sqlite: true) 사용을 강력히 권장합니다. YAML보다 5-10배 빠릅니다.
storage:
  sqlite: true

# ───────────────────────────────────────────────────────────────────────────────
# 가격 평활화 및 변동성 보호 [PERF: MINIMAL]
# ───────────────────────────────────────────────────────────────────────────────
price-smoothing:
  enabled: true
  # EMA Alpha (0.0 - 1.0): 가격 적응 속도. 권장: 0.3
  ema-alpha: 0.3
  # 주기당 최대 허용 가격 변동폭(%). 권장: 15.0
  max-change-percent: 15.0

# ───────────────────────────────────────────────────────────────────────────────
# 인플레이션 / 디플레이션 시스템 [PERF: MINIMAL]
# ───────────────────────────────────────────────────────────────────────────────
inflation:
  enabled: false
  # 주기당 변화율. 양수 = 인플레이션, 음수 = 디플레이션.
  rate-per-cycle: 0.01
  category-rates:
    ores: 0.02
    food: 0.0
    building: 0.01
    mob-drops: 0.01
  # 접속 중인 플레이어가 있을 때만 적용.
  require-players: true
  # 기본 가격 대비 최대 이탈 허용치(%).
  max-deviation-percent: 200.0

# ───────────────────────────────────────────────────────────────────────────────
# 평균 회귀 (부정 조작 방지) [PERF: MINIMAL]
# ───────────────────────────────────────────────────────────────────────────────
# 활동이 없을 때 가격을 서서히 기본 가격으로 되돌립니다.
price-reversion:
  enabled: true
  # 주기당 좁혀지는 가격 차이 비율. 권장: 2.0%
  rate-percent-per-cycle: 2.0
  # 해당 주기에 거래가 전혀 없었을 때만 적용.
  only-when-idle: true

# ───────────────────────────────────────────────────────────────────────────────
# 인벤토리 기반 가격 영향 [PERF: LOW]
# ───────────────────────────────────────────────────────────────────────────────
# 접속 중인 플레이어의 소지품에 따라 가격을 조정합니다.
price-inventory:
  enabled: false
  sensitivity: 0.02
  # 플레이어당 기준 수량. 초과 시 가격 하락, 미달 시 가격 상승.
  per-player-baseline: 64
  max-impact-percent: 10.0

# ───────────────────────────────────────────────────────────────────────────────
# 월드 스토리지 기반 가격 영향 [PERF: HIGH to CRITICAL]
# ───────────────────────────────────────────────────────────────────────────────
# 로드된 청크 내의 상자, 통 등을 스캔합니다. 
# ⚠️ 리소스를 가장 많이 소모하는 기능입니다.
price-world-storage:
  enabled: false
  scan-interval-seconds: 300
  sensitivity: 0.01
  global-baseline: 1000
  max-impact-percent: 5.0
  # 서버 틱당 처리할 청크 수. 권장: 50.
  chunks-per-tick: 50
  containers:
    chests: true
    barrels: true
    shulker-boxes: true
    hoppers: false
    droppers: false
    dispensers: false
    furnaces: false
    brewing-stands: false
  scan-shulker-contents: true
  excluded-worlds: []
  
  # 부정 조작 방지
  anti-manipulation:
    per-chunk-item-cap: 10000
    per-material-chunk-cap: 5000
    min-tps: 18.0
    log-suspicious: true

  # 스마트 캐시 [PERF: CRITICAL - 성능 향상을 위해 활성화 권장!]
  cache:
    enabled: true
    chunk-expiry-seconds: 600
    full-refresh-cycles: 5
    persist-to-disk: true

# ───────────────────────────────────────────────────────────────────────────────
# 초기 시장 설정
# ───────────────────────────────────────────────────────────────────────────────
# 데이터베이스가 없을 때만 적용됩니다.
seed-all-materials: false
include-default-important-items: true

# ───────────────────────────────────────────────────────────────────────────────
# 거래세 [PERF: MINIMAL]
# ───────────────────────────────────────────────────────────────────────────────
# 모든 구매 및 판매에 부과되는 세금 비율 (화폐 회수용).
transaction-tax-percent: 0.0

# ───────────────────────────────────────────────────────────────────────────────
# 구매/판매 스프레드 (차익 거래 방지)
# ───────────────────────────────────────────────────────────────────────────────
# 구매가와 판매가에 차이를 두어 악용을 방지합니다.
spread:
  enabled: true
  # 구매 시 추가되는 요율(%).
  buy-markup-percent: 3.0
  # 판매 시 차감되는 요율(%).
  sell-markdown-percent: 3.0

# ───────────────────────────────────────────────────────────────────────────────
# 판매 쿨다운 [PERF: NEGLIGIBLE]
# ───────────────────────────────────────────────────────────────────────────────
# 가격 조작을 위한 즉시 구매/판매를 방지합니다.
anti-arbitrage:
  sell-cooldown:
    enabled: true
    duration-seconds: 60

# ───────────────────────────────────────────────────────────────────────────────
# 아이템 블랙리스트
# ───────────────────────────────────────────────────────────────────────────────
# 시장에 절대 표시되지 않을 아이템들 (예: [BEDROCK, BARRIER]).
blacklist-items: []

# ───────────────────────────────────────────────────────────────────────────────
# 가상 자산 시스템 (HOLDINGS) [PERF: LOW]
# ───────────────────────────────────────────────────────────────────────────────
# 가상 보관소. 구매품은 여기로 들어가며 나중에 물리적으로 인출합니다.
holdings:
  enabled: true
  max-total-per-player: 100000
  auto-withdraw-on-login: false

# ───────────────────────────────────────────────────────────────────────────────
# 가상 배송 시스템 (권장하지 않음 - holdings를 사용하세요)
# ───────────────────────────────────────────────────────────────────────────────
delivery:
  enabled: true
  auto-claim-on-login: false
  max-pending-per-player: 10000

# ───────────────────────────────────────────────────────────────────────────────
# 시장 GUI 커스터마이징
# ───────────────────────────────────────────────────────────────────────────────
gui:
  # 아이템 쉬프트 클릭 시 스파크라인 차트 표시.
  details-chart: true

# ───────────────────────────────────────────────────────────────────────────────
# 상점 시스템 모드
# ───────────────────────────────────────────────────────────────────────────────
# DEFAULT = 스크롤 가능한 리스트 / CUSTOM = 카테고리 기반 상점.
shop:
  mode: DEFAULT
  main-shop: main
  command: shop
  custom:
    items-per-page: 45
    show-back-button: true
    back-button-slot: 49
    show-pagination: true
    prev-page-slot: 48
    next-page-slot: 50
    show-amount-button: true
    amount-button-slot: 45
    admin-edit: true
    # GUI 상의 가격 표시 형식
    price-lore:
      - "&7"
      - "&a좌클릭: &f구매: &6$%buy_price%"
      - "&c우클릭: &f판매: &6$%sell_price%"
      - "&7"
      - "&8재고: %stock% | 수요: %demand%"
    admin-lore: "&e⚡ 쉬프트 클릭: 아이템 편집 (관리자)"

# ───────────────────────────────────────────────────────────────────────────────
# 투자 시스템 [PERF: LOW]
# ───────────────────────────────────────────────────────────────────────────────
# 플레이어는 아이템에 투자하고 복리 이자를 받을 수 있습니다.
investments:
  enabled: true
  # 연간 수익률 (APR). 권장: 5.0
  apr-percent: 5.0

# ───────────────────────────────────────────────────────────────────────────────
# 히스토리 내보내기 (분석용)
# ───────────────────────────────────────────────────────────────────────────────
history-export:
  enabled: true
  folder: history

# ───────────────────────────────────────────────────────────────────────────────
# 자원 추적
# ───────────────────────────────────────────────────────────────────────────────
tracking:
  resources:
    enabled: true
    # 수집된 자원을 자동으로 시장의 '공급'에 추가합니까?
    # ⚠️ 주의: 대규모 디플레이션을 초래할 수 있습니다. 권장: false.
    apply-to-market: false
    sources:
      block-break: true
      mob-drops: true
      fishing: true

# ───────────────────────────────────────────────────────────────────────────────
# 시장 이벤트
# ───────────────────────────────────────────────────────────────────────────────
events:
  # 중첩되는 배수 한도.
  multiplier-cap: 10.0

# ═══════════════════════════════════════════════════════════════════════════════
# 웹 대시보드 설정 [PERF: LOW to MEDIUM]
# ═══════════════════════════════════════════════════════════════════════════════
web:
  enabled: true
  # 실제 운영 환경에서는 리버스 프록시(nginx 등)와 함께 127.0.0.1 사용 권장.
  host: 127.0.0.1
  port: 3434
  session-duration-hours: 2
  
  # 응답 압축 [PERF: LOW - 대역폭 절약]
  compression:
    enabled: true
    level: 4

  # 실시간 업데이트 방식
  poll-ms: 1000
  history-limit: 120
  sse:
    enabled: false
  websocket:
    enabled: true
  
  # API 요청 제한 (보안)
  rate-limit:
    enabled: true
    requests: 30
    per-seconds: 10
    exempt-ui: true
  
  # 권한 및 역할
  roles:
    default: TRADER
    trader-permission: endex.web.trade
    admin-view-permission: endex.web.admin
  
  # 웹 상의 마인크래프트 아이콘
  icons:
    enabled: false
    source: ""
  
  # 애드온 통합
  addons: []
  
  # 커스텀 웹 UI 오버라이드
  custom:
    enabled: false
    root: webui
    reload: false
    export-default: true
  
  # 자산 정보 API
  holdings:
    inventory:
      enabled: true
      include-enderchest: false
      cache-seconds: 15

# ═══════════════════════════════════════════════════════════════════════════════
# 로그 및 디버깅 [PERF: LOW - Verbose 모드는 I/O 증가]
# ═══════════════════════════════════════════════════════════════════════════════
logging:
  # 문제 해결 시에만 활성화하십시오. 로그 파일 크기가 매우 커질 수 있습니다.
  verbose: false

# ═══════════════════════════════════════════════════════════════════════════════
# 업데이트 확인
# ═══════════════════════════════════════════════════════════════════════════════
update-checker:
  enabled: true
  notify-ops: true

# ═══════════════════════════════════════════════════════════════════════════════
# 설정 끝
# ═══════════════════════════════════════════════════════════════════════════════